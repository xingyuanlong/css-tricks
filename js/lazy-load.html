<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>lazy-load</title>
    <style>
      .box {
        height: 500px;
        background-color: aquamarine;
      }
    </style>
  </head>
  <body>
    <div class="box">
      box
    </div>
    <img
      src="https://gw.alicdn.com/tfs/TB1DP0yAoY1gK0jSZFMXXaWcVXa-1190-70.png"
      alt=""
    />
    <div class="box">
      box
    </div>
    <img
      src="https://img.alicdn.com/tfs/TB1UDHOcwoQMeJjy0FoXXcShVXa-286-118.png"
      alt=""
    />
    <div class="box">
      box
    </div>
    <img
      class="lazy-img"
      data-src="https://img.alicdn.com/tfs/TB1WpjMcwMPMeJjy1XbXXcwxVXa-160-66.png"
      alt=""
    />
    <div class="box">
      box
    </div>
    <img
      class="lazy-img"
      data-src="https://img.alicdn.com/i2/2/TB1wh2sj.z1gK0jSZLewu29kVXa.png_170x170q90.jpg_.webp"
      alt=""
    />
    <div class="box">
      box
    </div>
    <img
      class="lazy-img"
      data-src="https://aecpm.alicdn.com/tfscom/TB1zsw5QXXXXXbNXFXXXXXXXXXX.png"
      alt=""
    />
    <div class="box">
      box
    </div>
    <img
      class="lazy-img"
      data-src="https://img.alicdn.com/imgextra/i1/32234056/TB2Ta9MfBmWBuNkSndVXXcsApXa_!!32234056-2-beehive-scenes.png_360x360xzq90.jpg_.webp"
      alt=""
    />
    <div class="box">
      box
    </div>
    <img
      class="lazy-img"
      data-src="https://img.alicdn.com/imgextra/i3/135/TB2e.KvXqmgSKJjSspiXXXyJFXa_!!135-2-luban.png_360x360q90.jpg_.webp"
      alt=""
    />
    <div class="box">
      box
    </div>
    <img
      class="lazy-img"
      data-src="https://gw.alicdn.com/tfs/TB1hJ2KX6ihSKJjy0FlXXadEXXa-254-318.png"
      alt=""
    />
    <div style="display: none;">
      <img
        src="https://img.alicdn.com/tfs/TB1N7kwRVXXXXbAapXXXXXXXXXX-500-127.png_250x250"
        alt=""
      />
    </div>
    <div style="display: none;">
      <img
        class="lazy-img"
        data-src="https://img.alicdn.com/tps/i3/TB1xWZUKVXXXXXbXXXXdpC3GXXX-33-15.png"
        alt=""
      />
    </div>
  </body>
  <script>
    function lazyLoadImg(className) {
      console.log("lazyLoadImg");
      let seeHeight = document.documentElement.clientHeight;
      let scroll =
        document.documentElement.scrollTop || document.body.scrollTop;
      let lazyImg = document.getElementsByClassName(className);
      Array.from(lazyImg).map((img) => {
        if (!img.src && img.offsetTop < scroll + seeHeight - 20) {
          img.src = img.getAttribute("data-src");
        }
      });
    }
    window.addEventListener("load", () => {
      window.addEventListener(
        "scroll",
        throttle(() => lazyLoadImg("lazy-img"), 150)
      );
    });
    var throttle = function (action, delay) {
      var statTime = 0;
      return function () {
        var currTime = +new Date();
        if (currTime - statTime > delay) {
          action.apply(this, arguments);
          statTime = currTime;
        }
      };
    };
  </script>
</html>
