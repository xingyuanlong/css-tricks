<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>排序算法</title>
  </head>

  <body>
    <h1>数据结构与算法 js描述</h1>
    <h2>参考数据</h2>
    <p>chrome 83, cpu i5 2G</p>
    
    <h3>1000</h3>
    <ul>
      <li>bubbleSort: 9ms</li>
      <li>selectSort: 7ms</li>
      <li>insertionSort: 2ms</li>
    </ul>
    <h3>10000</h3>
    <ul>
      <li>bubbleSort: 353ms</li>
      <li>selectSort: 312ms</li>
      <li>insertionSort: 34ms</li>
      <li>qSort: 0.2ms</li>
    </ul>
    <h3>100000</h3>
    <ul>
      <li>bubbleSort: 42243ms</li>
      <li>selectSort: 30889ms</li>
      <li>insertionSort: 3218ms</li>
      <li>qSort: 0.2ms</li>
    </ul>
    <h3>1000000</h3>
    <ul>
      <li>bubbleSort:</li>
      <li>selectSort:</li>
      <li>insertionSort: 3218ms</li>
      <li>qSort: 0.2ms</li>
    </ul>

    <script>
      const log = console.log;

      function TArray(numElements) {
        this.dataStore = new Array(numElements);
        this.pos = 0;
        this.numElements = numElements;
        this.insert = insert;
        this.toString = toString;
        this.clear = clear;
        this.setData = setData;
        this.swap = swap;
        this.bubbleSort = bubbleSort;
        this.selectSort = selectSort;
        this.insertionSort = insertionSort;
        this.qSort = qSort;

        function setData() {
          for (var i = 0; i < this.numElements; ++i) {
            this.dataStore[i] = Math.floor(
              Math.random() * (this.numElements + 1) * 2
            );
          }
          // this.toString();
        }

        function clear() {
          for (var i = 0; i < this.dataStore.length; ++i) {
            this.dataStore[i] = 0;
          }
        }

        function insert(element) {
          this.dataStore[this.pos++] = element;
        }

        function toString() {
          var str = "";
          for (var i = 0; i < this.dataStore.length; ++i) {
            str += this.dataStore[i] + " ";
            if ((i > 0) & (i % 10 == 0)) {
              str += "\n";
            }
          }
          log(str);
          return str;
        }

        function swap(arr, index1, index2) {
          var temp = arr[index1];
          arr[index1] = arr[index2];
          arr[index2] = temp;
        }
        // 冒泡排序
        function bubbleSort() {
          for (let i = 0; i < numElements; i++) {
            for (let j = 0; j < numElements - 1; j++) {
              if (this.dataStore[j + 1] < this.dataStore[j]) {
                [this.dataStore[j + 1], this.dataStore[j]] = [
                  this.dataStore[j],
                  this.dataStore[j + 1],
                ];
              }
            }
          }
        }

        // 选择排序
        function selectSort() {
          for (let i = 0; i < numElements; i++) {
            for (let j = i + 1; j < numElements; j++) {
              if (this.dataStore[i] > this.dataStore[j]) {
                [this.dataStore[i], this.dataStore[j]] = [
                  this.dataStore[j],
                  this.dataStore[i],
                ];
              }
            }
          }
        }
        // 插入排序
        function insertionSort() {
          let preIndex, current;
          for (let i = 1; i < numElements; i = i + 1) {
            preIndex = i - 1;
            current = this.dataStore[i];
            while (preIndex >= 0 && this.dataStore[preIndex] > current) {
              this.dataStore[preIndex + 1] = this.dataStore[preIndex];
              preIndex = preIndex - 1;
            }
            this.dataStore[preIndex + 1] = current;
          }
        }

        // 快速排序
        // 快速但占内存
        function qSort(list) {
          // debugger;
          if (list.length == 0) {
            return [];
          }
          var lesser = [];
          var greater = [];
          var pivot = list[0];
          for (var i = 1; i < list.length; i++) {
            if (list[i] < pivot) {
              lesser.push(list[i]);
            } else {
              greater.push(list[i]);
            }
          }
          return qSort(lesser).concat(pivot, qSort(greater));
        }
      }

      // test
      var len = 100;
      var arr = new TArray(len);
      arr.setData();

      console.time("bubbleSort");
      arr.bubbleSort();
      console.timeEnd("bubbleSort");
      // arr.toString();

      arr.setData();
      console.time("selectSort");
      arr.selectSort();
      console.timeEnd("selectSort");
      // arr.toString();

      arr.setData();
      console.time("insertionSort");
      arr.insertionSort();
      console.timeEnd("insertionSort");
      // arr.toString();

      arr.setData();
      console.time("qSort");
      var newArr = arr.qSort(arr.dataStore);
      console.timeEnd("qSort");
      log("newArr", newArr);

      arr.setData();
      console.time("sort");
      arr.dataStore.sort((x, y) => x - y);
      console.timeEnd("sort");
    </script>
  </body>
</html>
